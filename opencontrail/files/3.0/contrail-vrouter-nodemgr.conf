{%- from "opencontrail/map.jinja" import compute with context %}
{%- if compute.discovery.get('enabled', True) %}
[DISCOVERY]
server={{ compute.discovery.host }}
port=5998
{%- else %}
[COLLECTOR]
{%- set collector_members = [] %}
{%- for member in compute.collector.members %}
{%-   if member not in collector_members %}
{%-     do collector_members.append(member) %}
{%-   endif %}
{%- endfor %}
server_list={% for member in collector_members %}{{ member.host }}:8086{% if not loop.last %} {% endif %}{% endfor %}
{%- endif %}
