{%- from "opencontrail/map.jinja" import control with context %}
#
# Copyright (c) 2014 Juniper Networks, Inc. All rights reserved.
#
# DNS configuration options
#

[DEFAULT]
collectors= {% for member in control.analytics.members %}{{ member.host }}:8086 {% endfor %}
# dns_config_file=dns_config.xml
# named_config_file=contrail-named.conf                 # named config file
# named_config_directory=/etc/contrail/dns              # named config directory
# named_log_file=/var/log/contrail/contrail-named.log   # named log file
# rndc_config_file=contrail-rndc.conf                   # rndc config file
# rndc_secret=secretkey                                 # rndc secret
named_max_cache_size=32M # max-cache-size (bytes) per view, can be in K or M
named_max_retransmissions=12
named_retransmission_interval=1000 # msec
hostip={{ control.bind.address }} # Resolved IP of `hostname`
{%- if control.name is defined %}
hostname={{ control.name }}
{%- else %}
hostname={{ pillar.linux.system.name }}
{%- endif %}
# http_server_port=8092
# dns_server_port=53
# log_category=
# log_disable=0
log_file=/var/log/contrail/contrail-dns.log
# log_files_count=10
# log_file_size=1048576 # 1MB
log_level=SYS_NOTICE
log_local=1
# test_mode=0
# log_property_file= # log4cplus property file
# xmpp_dns_auth_enable=0
# xmpp_server_cert=/etc/contrail/ssl/certs/server.pem
# xmpp_server_key=/etc/contrail/ssl/private/server-privkey.pem
# xmpp_ca_cert=/etc/contrail/ssl/certs/ca-cert.pem

# Sandesh send rate limit can be used to throttle system logs transmitted per
# second. System logs are dropped if the sending rate is exceeded
# sandesh_send_rate_limit=
{%- if control.get('sandesh_send_rate_limits', {}).get('dns') %}
sandesh_send_rate_limit={{ control.sandesh_send_rate_limits.dns }}
{%- elif control.get('sandesh_send_rate_limits', {}).get('global') %}
sandesh_send_rate_limit={{ control.sandesh_send_rate_limits.global }}
{%- endif %}

[CONFIGDB]
#AMQP related configs
rabbitmq_server_list={% for member in control.message_queue.members -%}{{ member.host }}:{{ member.get('port', 5672) }} {% endfor %}
rabbitmq_user={{ control.message_queue.get('user', 'guest') }}
rabbitmq_password={{ control.message_queue.get('password', 'guest') }}
rabbitmq_vhost={{ control.message_queue.get('vhost', '') }}
# rabbitmq_use_ssl=false
# rabbitmq_ssl_version=
# rabbitmq_ssl_keyfile=
# rabbitmq_ssl_certfile=
# rabbitmq_ssl_ca_certs=
#
config_db_server_list={% for member in control.database.members %}{{ member.host }}:9041 {% endfor %}
# config_db_username=
# config_db_password=

[SANDESH]
# sandesh_ssl_enable=false
# introspect_ssl_enable=false
# sandesh_keyfile=/etc/contrail/ssl/private/server-privkey.pem
# sandesh_certfile=/etc/contrail/ssl/certs/server.pem
# sandesh_ca_cert=/etc/contrail/ssl/certs/ca-cert.pem
